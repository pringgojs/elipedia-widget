!function(){const e="elipedia-chat-iframe",t="elipedia-chat-toggle",n="elipedia_jwt_token",i="elipedia-floating-container";let o=null;async function a(){const e=localStorage.getItem(n??"dummy_token");try{const t=await fetch(`https://dev.elipedia.id/api/check-session/${e}`,{method:"GET"});if(!t.ok)return!1;const n=await t.json();return console.log("Check session active:",n),!!n.active}catch(e){return!1}}function d(){return null!==document.getElementById(i)}function l(){const e=document.getElementById(i);e&&e.remove()}function r(e="500px"){let t=document.getElementById(i);return t||(t=document.createElement("div"),t.id=i,document.body.appendChild(t)),t.style.position="fixed",t.style.bottom="500px"==e?"80px":"120px",t.style.right="20px",t.style.width="350px",t.style.height=e,t.style.zIndex="99999",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.background="none",t.style.boxShadow="0 4px 12px rgba(0,0,0,0.3)",t.style.borderRadius="10px",t.style.padding="0",t}function p(){r("340px").innerHTML='\n      <form id="elipedia-login-form" autocomplete="off" style="background:#fff;border-radius:10px;padding:32px 24px 32px 24px;box-shadow:0 2px 8px rgba(0,0,0,0.08);font-family:Arial,sans-serif;display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;gap:1.2rem;max-width:320px;">\n        <h3 style="margin:0 0 1.5rem 0;font-size:1.25rem;font-weight:600;text-align:center;color:#166534;width:100%;">Login ke Elipedia Chat</h3>\n        <label style="font-size:.95rem;font-weight:500;color:#222;width:100%;padding-bottom:2px;">Email\n          <input type="email" name="email" value="jodhy.hermawan@elitery.com" required style="font-size:14px;border-radius:6px;line-height:1.5;padding:8px 12px;border:2px solid #dee1e2;color:rgb(14,14,16);background:#dee1e2;display:block;height:38px;width:100%;margin-top:0.25rem;box-sizing:border-box;">\n        </label>\n        <label style="font-size:.95rem;font-weight:500;color:#222;width:100%;padding-bottom:2px;">Nama\n          <input type="text" name="name" value="jodhy" required style="font-size:14px;border-radius:6px;line-height:1.5;padding:8px 12px;border:2px solid #dee1e2;color:rgb(14,14,16);background:#dee1e2;display:block;height:38px;width:100%;margin-top:0.25rem;box-sizing:border-box;">\n        </label>\n        <label style="font-size:.95rem;font-weight:500;color:#222;width:100%;padding-bottom:2px;">Username\n          <input type="text" name="username" value="jodhy12" required style="font-size:14px;border-radius:6px;line-height:1.5;padding:8px 12px;border:2px solid #dee1e2;color:rgb(14,14,16);background:#dee1e2;display:block;height:38px;width:100%;margin-top:0.25rem;box-sizing:border-box;">\n        </label>\n        <button type="submit" style="margin-top:.5rem;width:100%;background:linear-gradient(90deg,#166534,#22c55e);color:#fff;padding:.85rem 0;border:none;border-radius:.5rem;font-size:1.1rem;font-weight:600;box-shadow:0 2px 8px rgba(34,197,94,0.08);transition:background .2s,box-shadow .2s;cursor:pointer;">Login</button>\n      </form>\n    ';document.getElementById("elipedia-login-form").onsubmit=function(e){e.preventDefault();const t=this.email.value,i=this.name.value,o=this.username.value,a=window.btoa(t+":"+(new Date).getTime()),d={email:t,preferred_username:o,name:i,sub:window.btoa(t),authId:a};localStorage.setItem("elipedia_x_data",window.btoa(JSON.stringify(d))),localStorage.setItem(n,a);const r=document.createElement("form");r.action="https://dev.elipedia.id/login/callback",r.target="elipedia_login_popup",r.method="GET",r.style.display="none",r.innerHTML=`\n        <input type="text" name="verify_token" value="UcmkbFpIPjSyLdCxcXDJCesgzCAPauzSn5IgSFivkq" />\n        <input type="text" name="fromRedirect" value="true" />\n        <input type="text" name="x-data" value="${window.btoa(JSON.stringify(d))}" />\n        <input type="text" name="widget" value="true" />\n      `,document.body.appendChild(r);const p=window.open("","elipedia_login_popup","width=500,height=700");r.submit();const s=setInterval(function(){p.closed&&(clearInterval(s),l())},500)}}function s(){if(document.getElementById(t))return;const n=document.createElement("div");n.id=t,n.innerHTML="<img src='../icon.png' alt='Elipedia Chat' style='width: 100%; height: 100%; object-fit: cover;'>",n.style.cssText="\n    position: fixed;\n    bottom: 20px;\n    right: 20px;\n    width: 50px;\n    height: 50px;\n    border-radius: 50%;\n    background-color: none;\n    color: white;\n    font-size: 24px;\n    text-align: center;\n    line-height: 60px;\n    cursor: pointer;\n    z-index: 99999;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    user-select: none;\n  ",n.title="Buka Chat Elipedia",n.addEventListener("click",()=>{console.log("Widget Elipedia Chat akan segera hadir!"),d()?l():(console.log("isLoggedIn()",a()),a().then(t=>{t?(console.log("User sudah login, menampilkan iframe..."),function(){const t=r("500px");t.innerHTML="";let n=document.getElementById(e);n||(n=document.createElement("iframe"),n.id=e,n.src="https://dev.elipedia.id/",n.style.cssText="\n    position: fixed;\n    bottom: 80px;\n    right: 20px;\n    width: 350px;\n    height: 500px;\n    border: none;\n    border-radius: 10px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    z-index: 99999;\n    display: none;\n  position:static;display:block;width:100%;height:100%;",n.setAttribute("title","Elipedia Chat")),t.appendChild(n)}()):(console.log("User belum login, menampilkan form login..."),p())}))}),document.body.appendChild(n)}function c(){s(),o||(o=setInterval(async()=>{await a()||(d()||r("340px"),p(),console.log("Polling: User belum login, menampilkan form login..."))},1e4))}"complete"===document.readyState||"interactive"===document.readyState?c():document.addEventListener("DOMContentLoaded",c)}();